/*! For license information please see 69ff6227.4d2e276b.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[957],{2192:(e,n,t)=>{var s=t(3696),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,n,t){var s,r={},a=null,d=null;for(s in void 0!==t&&(a=""+t),void 0!==n.key&&(a=""+n.key),void 0!==n.ref&&(d=n.ref),n)l.call(n,s)&&!c.hasOwnProperty(s)&&(r[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===r[s]&&(r[s]=n[s]);return{$$typeof:i,type:e,key:a,ref:d,props:r,_owner:o.current}}n.Fragment=r,n.jsx=a,n.jsxs=a},2540:(e,n,t)=>{e.exports=t(2192)},5141:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>a});var s=t(2540),i=t(3023);const r={id:"s3",title:"S3",description:"s3"},l="S3",o={id:"destinations/s3",title:"S3",description:"s3",source:"@site/versioned_docs/version-0.0.1/destinations/s3.md",sourceDirName:"destinations",slug:"/destinations/s3",permalink:"/docs/destinations/s3",draft:!1,unlisted:!1,tags:[],version:"0.0.1",lastUpdatedAt:1724990314e3,frontMatter:{id:"s3",title:"S3",description:"s3"},sidebar:"integrations",previous:{title:"Redshift",permalink:"/docs/destinations/redshift"},next:{title:"S3 Glue",permalink:"/docs/destinations/s3-glue"}},c={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setup guide",id:"setup-guide",level:2},{value:"Step 1: Set up S3",id:"step-1-set-up-s3",level:3},{value:"Create bucket a Policy",id:"create-bucket-a-policy",level:4},{value:"Authentication Option 1: Using an IAM Role (Most secure)",id:"authentication-option-1-using-an-iam-role-most-secure",level:4},{value:"Authentication Option 2: Using an IAM User",id:"authentication-option-2-using-an-iam-user",level:5},{value:"Step 2: Set up the S3 destination connector in HeroPixel",id:"step-2-set-up-the-s3-destination-connector-in-heropixel",level:3},{value:"Supported sync modes",id:"supported-sync-modes",level:2},{value:"Supported Output schema",id:"supported-output-schema",level:2},{value:"Avro",id:"avro",level:3},{value:"Configuration",id:"configuration",level:4},{value:"Data schema",id:"data-schema",level:4},{value:"CSV",id:"csv",level:3},{value:"JSON Lines (JSONL)",id:"json-lines-jsonl",level:3},{value:"Parquet",id:"parquet",level:3},{value:"Configuration",id:"configuration-1",level:4},{value:"Data schema",id:"data-schema-1",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"s3",children:"S3"}),"\n",(0,s.jsx)(n.p,{children:"This page guides you through the process of setting up the S3 destination connector."}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"List of required fields:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"S3 Bucket Name"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"S3 Bucket Path"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"S3 Bucket Region"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If you are using STS Assume Role, you must provide the following:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Role ARN"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Otherwise, if you are using AWS credentials you must provide the following:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Access Key ID"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Secret Access Key"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If you are using an Instance Profile, you may omit the Access Key ID and Secret Access Key,\nas well as, the Role ARN."}),"\n",(0,s.jsx)(n.p,{children:"Additionally the following prerequisites are required:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Allow connections from HeroPixelserver to your AWS S3/ Minio S3 cluster (if they exist in\nseparate VPCs)."}),"\n",(0,s.jsx)(n.li,{children:"An S3 bucket with credentials, a Role ARN, or an instance profile with read/write permissions configured for\nthe host (ec2, eks)."}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit",children:"Enforce encryption of data in transit"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"setup-guide",children:"Setup guide"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-set-up-s3",children:"Step 1: Set up S3"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://console.aws.amazon.com/iam/",children:"Sign in"})," to your AWS account."]}),"\n",(0,s.jsxs)(n.p,{children:["Prepare S3 bucket that will be used as destination, see\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/create-bucket-overview.html",children:"this"})," to create\nan S3 bucket."]}),"\n",(0,s.jsxs)(n.p,{children:["NOTE: If the S3 cluster is not configured to use TLS, the connection to Amazon S3 silently reverts\nto an unencrypted connection. HeroPixelrecommends all connections be configured to use TLS/SSL as\nsupport for AWS's\n",(0,s.jsx)(n.a,{href:"https://aws.amazon.com/compliance/shared-responsibility-model/",children:"shared responsibility model"})]}),"\n",(0,s.jsx)(n.h4,{id:"create-bucket-a-policy",children:"Create bucket a Policy"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Open the ",(0,s.jsx)(n.a,{href:"https://console.aws.amazon.com/iam/home#home",children:"IAM console"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["In the IAM dashboard, select ",(0,s.jsx)(n.strong,{children:"Policies"}),", then click ",(0,s.jsx)(n.strong,{children:"Create Policy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Select the ",(0,s.jsx)(n.strong,{children:"JSON"})," tab, then paste the following JSON into the Policy editor (be sure to substitute in your bucket name):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "s3:PutObject",\n        "s3:GetObject",\n        "s3:DeleteObject",\n        "s3:PutObjectAcl",\n        "s3:ListBucket",\n        "s3:ListBucketMultipartUploads",\n        "s3:AbortMultipartUpload",\n        "s3:GetBucketLocation"\n      ],\n      "Resource": [\n        "arn:aws:s3:::YOUR_BUCKET_NAME/*",\n        "arn:aws:s3:::YOUR_BUCKET_NAME"\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["At this time, object-level permissions alone are not sufficient to successfully authenticate the connection. Please ensure you include the ",(0,s.jsx)(n.strong,{children:"bucket-level"})," permissions as provided in the example above."]})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["Give your policy a descriptive name, then click ",(0,s.jsx)(n.strong,{children:"Create policy"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"authentication-option-1-using-an-iam-role-most-secure",children:"Authentication Option 1: Using an IAM Role (Most secure)"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["S3 authentication using an IAM role member must be enabled by a member of the HeroPixelteam. If you'd like to use this feature, please ",(0,s.jsx)(n.a,{href:"mailto:support@heropixel.com",children:"contact the tech team"})," for more information."]})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In the IAM dashboard, click ",(0,s.jsx)(n.strong,{children:"Roles"}),", then ",(0,s.jsx)(n.strong,{children:"Create role"}),". "]}),"\n",(0,s.jsx)(n.li,{children:"Choose the appropriate trust entity and attach the policy you created."}),"\n",(0,s.jsxs)(n.li,{children:["Set up a trust relationship for the role. For example for ",(0,s.jsx)(n.strong,{children:"AWS account"})," trusted entity use default AWS account on your instance (it will be used to assume role). To use ",(0,s.jsx)(n.strong,{children:"External ID"})," set it to environment variables as ",(0,s.jsx)(n.code,{children:'export AWS_ASSUME_ROLE_EXTERNAL_ID="{your-external-id}"'}),". Edit the trust relationship policy to reflect this:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "AWS": "arn:aws:iam::{your-aws-account-id}:user/{your-username}"\n            },\n            "Action": "sts:AssumeRole",\n            "Condition": {\n                "StringEquals": {\n                    "sts:ExternalId": "{your-external-id}"\n                }\n            }\n        }\n    ]\n}\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Choose the ",(0,s.jsx)(n.strong,{children:"AWS account"})," trusted entity type."]}),"\n",(0,s.jsx)(n.li,{children:"Set up a trust relationship for the role. This allows the HeroPixelinstance's AWS account to assume this role. You will also need to specify an external ID, which is a secret key that the trusting service (HHeroPixeland the trusted role (the role you're creating) both know. This ID is used to prevent the \"confused deputy\" problem. The External ID should be your HeHeroPixelrkspace ID, which can be found in the URL of your workspace page. Edit the trust relationship policy to include the external ID:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Effect": "Allow",\n            "Principal": {\n                "AWS": "arn:aws:iam::094410056844:user/delegated_access_user"\n            },\n            "Action": "sts:AssumeRole",\n            "Condition": {\n                "StringEquals": {\n                    "sts:ExternalId": "{your-heropixel-workspace-id}"\n                }\n            }\n        }\n    ]\n}\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsx)(n.li,{children:"Complete the role creation and note the Role ARN."}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.strong,{children:"Attach policies directly"}),", then find and check the box for your new policy. Click ",(0,s.jsx)(n.strong,{children:"Next"}),", then ",(0,s.jsx)(n.strong,{children:"Add permissions"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h5,{id:"authentication-option-2-using-an-iam-user",children:"Authentication Option 2: Using an IAM User"}),"\n",(0,s.jsxs)(n.p,{children:["Use an existing or create new\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#:~:text=IAM%20User%20Guide.-,Programmatic%20access,-You%20must%20provide",children:"Access Key ID and Secret Access Key"}),"."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In the IAM dashboard, click ",(0,s.jsx)(n.strong,{children:"Users"}),". Select an existing IAM user or create a new one by clicking ",(0,s.jsx)(n.strong,{children:"Add users"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["If you are using an ",(0,s.jsx)(n.em,{children:"existing"})," IAM user, click the ",(0,s.jsx)(n.strong,{children:"Add permissions"})," dropdown menu and select ",(0,s.jsx)(n.strong,{children:"Add permissions"}),". If you are creating a ",(0,s.jsx)(n.em,{children:"new"})," user, you will be taken to the Permissions screen after selecting a name."]}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.strong,{children:"Attach policies directly"}),", then find and check the box for your new policy. Click ",(0,s.jsx)(n.strong,{children:"Next"}),", then ",(0,s.jsx)(n.strong,{children:"Add permissions"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["After successfully creating your user, select the ",(0,s.jsx)(n.strong,{children:"Security credentials"})," tab and click ",(0,s.jsx)(n.strong,{children:"Create access key"}),". You will be prompted to select a use case and add optional tags to your access key. Click ",(0,s.jsx)(n.strong,{children:"Create access key"})," to generate the keys."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-set-up-the-s3-destination-connector-in-heropixel",children:"Step 2: Set up the S3 destination connector in HeroPixel"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Go to local HeroPixelpage."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the left navigation bar, click ",(0,s.jsx)(n.strong,{children:"Destinations"}),". In the top-right corner, click ",(0,s.jsx)(n.strong,{children:"+ new\ndestination"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["On the destination setup page, select ",(0,s.jsx)(n.strong,{children:"S3"})," from the Destination type dropdown and enter a name\nfor this connector."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Configure fields: _ ",(0,s.jsx)(n.strong,{children:"Access Key Id"})," _ See\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys",children:"this"}),"\non how to generate an access key. _ See\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2_instance-profiles.html",children:"this"}),"\non how to create a instanceprofile. _ We recommend creating an HeroPixelspecific user. This user\nwill require\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_s3_rw-bucket.html",children:"read and write permissions"}),"\nto objects in the staging bucket. _ If the Access Key and Secret Access Key are not provided, the\nauthentication will rely either on the Role ARN using STS Assume Role or on the instanceprofile."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["_ ",(0,s.jsx)(n.strong,{children:"Secret Access Key"})," _ Corresponding key to\nthe above key id. _ Make sure your S3 bucket is accessible from the machine running HeroPixel _\nThis depends on your networking setup. _ You can check AWS S3 documentation with a tutorial on\nhow to properly configure your S3's access\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-overview.html",children:"here"}),". _ If\nyou use instance profile authentication, make sure the role has permission to read/write on the\nbucket. _ The easiest way to verify if HeroPixelis able to connect to your S3 bucket is via the\ncheck connection tool in the UI. _ ",(0,s.jsx)(n.strong,{children:"S3 Bucket Name"})," _ See\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/create-bucket-overview.html",children:"this"})," to\ncreate an S3 bucket. _ ",(0,s.jsx)(n.strong,{children:"S3 Bucket Path"})," _ Subdirectory under the above bucket to sync the data\ninto. _ ",(0,s.jsx)(n.strong,{children:"S3 Bucket Region"})," _ See\n",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-available-regions",children:"here"}),"\nfor all region codes. _ ",(0,s.jsx)(n.strong,{children:"S3 Path Format"})," _ Additional string format on how to store data under\nS3 Bucket Path. Default value is ",(0,s.jsx)(n.code,{children:"${NAMESPACE}/${STREAM_NAME}/${YEAR}_${MONTH}_${DAY}_${EPOCH}_"}),".\n_ ",(0,s.jsx)(n.strong,{children:"S3 Endpoint"})," _ Leave empty if using AWS S3, fill in S3 URL if using Minio S3."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"S3 Filename pattern"})," * The pattern allows you to set the file-name format for the S3\nstaging file(s), next placeholders combinations are currently supported: ",(0,s.jsx)(n.code,{children:"{date}"}),",\n",(0,s.jsx)(n.code,{children:"{date:yyyy_MM}"}),", ",(0,s.jsx)(n.code,{children:"{timestamp}"}),", ",(0,s.jsx)(n.code,{children:"{timestamp:millis}"}),", ",(0,s.jsx)(n.code,{children:"{timestamp:micros}"}),", ",(0,s.jsx)(n.code,{children:"{part_number}"}),",\n",(0,s.jsx)(n.code,{children:"{sync_id}"}),", ",(0,s.jsx)(n.code,{children:"{format_extension}"}),". Please, don't use empty space and not supportable\nplaceholders, as they won't recognized."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Click ",(0,s.jsx)(n.code,{children:"Set up destination"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The full path of the output data with the default S3 Path Format\n",(0,s.jsx)(n.code,{children:"${NAMESPACE}/${STREAM_NAME}/${YEAR}_${MONTH}_${DAY}_${EPOCH}_"})," is:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"<bucket-name>/<source-namespace-if-exists>/<stream-name>/<upload-date>_<epoch>_<partition-id>.<format-extension>\n"})}),"\n",(0,s.jsx)(n.p,{children:"For example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"testing_bucket/data_output_path/public/users/2021_01_01_1234567890_0.csv.gz\n\u2191              \u2191                \u2191      \u2191     \u2191          \u2191          \u2191 \u2191\n|              |                |      |     |          |          | format extension\n|              |                |      |     |          |          unique incremental part id\n|              |                |      |     |          milliseconds since epoch\n|              |                |      |     upload date in YYYY_MM_DD\n|              |                |      stream name\n|              |                source namespace (if it exists)\n|              bucket path\nbucket name\n"})}),"\n",(0,s.jsx)(n.p,{children:"The rationales behind this naming pattern are:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Each stream has its own directory."}),"\n",(0,s.jsx)(n.li,{children:"The data output files can be sorted by upload time."}),"\n",(0,s.jsx)(n.li,{children:"The upload time composes of a date part and millis part so that it is both readable and unique."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"But it is possible to further customize by using the available variables to format the bucket path:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${NAMESPACE}"}),": Namespace where the stream comes from or configured by the connection namespace\nfields."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${STREAM_NAME}"}),": Name of the stream"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${YEAR}"}),": Year in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${MONTH}"}),": Month in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${DAY}"}),": Day in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${HOUR}"}),": Hour in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${MINUTE}"})," : Minute in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${SECOND}"}),": Second in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${MILLISECOND}"}),": Millisecond in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${EPOCH}"}),": Milliseconds since Epoch in which the sync was writing the output data in."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"${UUID}"}),": random uuid string"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Note:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Multiple ",(0,s.jsx)(n.code,{children:"/"})," characters in the S3 path are collapsed into a single ",(0,s.jsx)(n.code,{children:"/"})," character."]}),"\n",(0,s.jsxs)(n.li,{children:["If the output bucket contains too many files, the part id variable is using a ",(0,s.jsx)(n.code,{children:"UUID"})," instead. It\nuses sequential ID otherwise."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Please note that the stream name may contain a prefix, if it is configured on the connection. A data\nsync may create multiple files as the output files can be partitioned by size (targeting a size of\n200MB compressed or lower) ."}),"\n",(0,s.jsx)(n.h2,{id:"supported-sync-modes",children:"Supported sync modes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Feature"}),(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"Support"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Notes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Full Refresh Sync"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Warning: this mode deletes all previously synced data in the configured bucket path."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Incremental - Append Sync"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"\u2705"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Warning: HeroPixelprovides at-least-once delivery."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Incremental - Append + Deduped"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Namespaces"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"\u274c"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Setting a specific bucket path is equivalent to having separate namespaces."})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"The HeroPixelS3 destination allows you to sync data to AWS S3 or Minio S3. Each stream is written to\nits own directory under the bucket."}),"\n",(0,s.jsx)(n.p,{children:'\u26a0\ufe0f Please note that under "Full Refresh Sync" mode, data in the configured bucket and path will be\nwiped out before each sync. We recommend you to provision a dedicated S3 resource for this sync to\nprevent unexpected data deletion from misconfiguration. \u26a0\ufe0f'}),"\n",(0,s.jsx)(n.h2,{id:"supported-output-schema",children:"Supported Output schema"}),"\n",(0,s.jsx)(n.p,{children:"Each stream will be outputted to its dedicated directory according to the configuration. The\ncomplete datastore of each stream includes all the output files under that directory. You can think\nof the directory as equivalent of a Table in the database world."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Under Full Refresh Sync mode, old output files will be purged before new files are created."}),"\n",(0,s.jsx)(n.li,{children:"Under Incremental - Append Sync mode, new output files will be added that only contain the new\ndata."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"avro",children:"Avro"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://avro.apache.org/",children:"Apache Avro"})," serializes data in a compact binary format. Currently, the\nHeroPixelS3 Avro connector always uses the\n",(0,s.jsx)(n.a,{href:"http://avro.apache.org/docs/current/spec.html#binary_encoding",children:"binary encoding"}),", and assumes that\nall data records follow the same schema."]}),"\n",(0,s.jsx)(n.h4,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"Here is the available compression codecs:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"No compression"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"deflate"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Compression level","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Range ",(0,s.jsx)(n.code,{children:"[0, 9]"}),". Default to 0."]}),"\n",(0,s.jsx)(n.li,{children:"Level 0: no compression & fastest."}),"\n",(0,s.jsx)(n.li,{children:"Level 9: best compression & slowest."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"bzip2"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"xz"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Compression level","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Range ",(0,s.jsx)(n.code,{children:"[0, 9]"}),". Default to 6."]}),"\n",(0,s.jsx)(n.li,{children:"Level 0-3 are fast with medium compression."}),"\n",(0,s.jsx)(n.li,{children:"Level 4-6 are fairly slow with high compression."}),"\n",(0,s.jsx)(n.li,{children:"Level 7-9 are like level 6 but use bigger dictionaries and have higher memory requirements.\nUnless the uncompressed size of the file exceeds 8 MiB, 16 MiB, or 32 MiB, it is waste of\nmemory to use the presets 7, 8, or 9, respectively."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"zstandard"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Compression level","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Range ",(0,s.jsx)(n.code,{children:"[-5, 22]"}),". Default to 3."]}),"\n",(0,s.jsxs)(n.li,{children:["Negative levels are 'fast' modes akin to ",(0,s.jsx)(n.code,{children:"lz4"})," or ",(0,s.jsx)(n.code,{children:"snappy"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Levels above 9 are generally for archival purposes."}),"\n",(0,s.jsx)(n.li,{children:"Levels above 18 use a lot of memory."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Include checksum","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If set to ",(0,s.jsx)(n.code,{children:"true"}),", a checksum will be included in each data block."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"snappy"})}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"data-schema",children:"Data schema"}),"\n",(0,s.jsx)(n.p,{children:"Under the hood, an HeroPixeldata stream in JSON schema is first converted to an Avro schema, then the\nJSON object is converted to an Avro record. Because the data stream can come from any data source,\nthe JSON to Avro conversion process has arbitrary rules and limitations."}),"\n",(0,s.jsx)(n.h3,{id:"csv",children:"CSV"}),"\n",(0,s.jsx)(n.p,{children:"Like most of the other HeroPixeldestination connectors, usually the output has three columns: a UUID,\nan emission timestamp, and the data blob. With the CSV output, it is possible to normalize\n(flatten) the data blob to multiple columns."}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Column"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Condition"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_ab_id"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Always exists"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"A uuid assigned by HeroPixelto each processed record."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_emitted_at"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Always exists."}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"A timestamp representing when the event was pulled from the data source."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_data"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"When no normalization (flattening) is needed, all data reside under this column as a json blob."}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"root level fields"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"When root level normalization (flattening) is selected, the root level fields are expanded."}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"For example, given the following json object from a source:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "user_id": 123,\n  "name": {\n    "first": "John",\n    "last": "Doe"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"With no normalization, the output CSV is:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_ab_id"})}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_emitted_at"})}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_data"})})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"26d73cde-7eb1-4e1e-b7db-a4c03b4cf206"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"1622135805000"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:'{ "user_id": 123, name: { "first": "John", "last": "Doe" } }'})})]})})]}),"\n",(0,s.jsx)(n.p,{children:"With root level normalization, the output CSV is:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_ab_id"})}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"_airbyte_emitted_at"})}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"user_id"})}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"name"})})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"26d73cde-7eb1-4e1e-b7db-a4c03b4cf206"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"1622135805000"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"123"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:'{ "first": "John", "last": "Doe" }'})})]})})]}),"\n",(0,s.jsxs)(n.p,{children:["Output files can be compressed. The default option is GZIP compression. If compression is selected,\nthe output filename will have an extra extension (GZIP: ",(0,s.jsx)(n.code,{children:".csv.gz"}),")."]}),"\n",(0,s.jsx)(n.h3,{id:"json-lines-jsonl",children:"JSON Lines (JSONL)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://jsonlines.org/",children:"JSON Lines"})," is a text format with one JSON per line. Each line has a\nstructure as follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "_airbyte_ab_id": "<uuid>",\n  "_airbyte_emitted_at": "<timestamp-in-millis>",\n  "_airbyte_data": "<json-data-from-source>"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"For example, given the following two json objects from a source:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "user_id": 123,\n    "name": {\n      "first": "John",\n      "last": "Doe"\n    }\n  },\n  {\n    "user_id": 456,\n    "name": {\n      "first": "Jane",\n      "last": "Roe"\n    }\n  }\n]\n'})}),"\n",(0,s.jsx)(n.p,{children:"They will be like this in the output file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:'{ "_airbyte_ab_id": "26d73cde-7eb1-4e1e-b7db-a4c03b4cf206", "_airbyte_emitted_at": "1622135805000", "_airbyte_data": { "user_id": 123, "name": { "first": "John", "last": "Doe" } } }\n{ "_airbyte_ab_id": "0a61de1b-9cdd-4455-a739-93572c9a5f20", "_airbyte_emitted_at": "1631948170000", "_airbyte_data": { "user_id": 456, "name": { "first": "Jane", "last": "Roe" } } }\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Output files can be compressed. The default option is GZIP compression. If compression is selected,\nthe output filename will have an extra extension (GZIP: ",(0,s.jsx)(n.code,{children:".jsonl.gz"}),")."]}),"\n",(0,s.jsx)(n.h3,{id:"parquet",children:"Parquet"}),"\n",(0,s.jsx)(n.h4,{id:"configuration-1",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"The following configuration is available to configure the Parquet output:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"Type"}),(0,s.jsx)(n.th,{style:{textAlign:"center"},children:"Default"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"compression_codec"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"enum"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:(0,s.jsx)(n.code,{children:"UNCOMPRESSED"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"Compression algorithm"}),". Available candidates are: ",(0,s.jsx)(n.code,{children:"UNCOMPRESSED"}),", ",(0,s.jsx)(n.code,{children:"SNAPPY"}),", ",(0,s.jsx)(n.code,{children:"GZIP"}),", ",(0,s.jsx)(n.code,{children:"LZO"}),", ",(0,s.jsx)(n.code,{children:"BROTLI"}),", ",(0,s.jsx)(n.code,{children:"LZ4"}),", and ",(0,s.jsx)(n.code,{children:"ZSTD"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"block_size_mb"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"integer"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"128 (MB)"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"Block size (row group size)"})," in MB. This is the size of a row group being buffered in memory. It limits the memory usage when writing. Larger values will improve the IO when reading, but consume more memory when writing."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"max_padding_size_mb"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"integer"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"8 (MB)"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"Max padding size"})," in MB. This is the maximum size allowed as padding to align row groups. This is also the minimum size of a row group."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"page_size_kb"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"integer"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"1024 (KB)"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"Page size"})," in KB. The page size is for compression. A block is composed of pages. A page is the smallest unit that must be read fully to access a single record. If this value is too small, the compression will deteriorate."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"dictionary_page_size_kb"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"integer"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"1024 (KB)"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"Dictionary Page Size"})," in KB. There is one dictionary page per column per row group when dictionary encoding is used. The dictionary page size works like the page size but for dictionary."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"dictionary_encoding"})}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:"boolean"}),(0,s.jsx)(n.td,{style:{textAlign:"center"},children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"Dictionary encoding"}),". This parameter controls whether dictionary encoding is turned on."]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["These parameters are related to the ",(0,s.jsx)(n.code,{children:"ParquetOutputFormat"}),". See the\n",(0,s.jsx)(n.a,{href:"https://www.javadoc.io/doc/org.apache.parquet/parquet-hadoop/1.12.0/org/apache/parquet/hadoop/ParquetOutputFormat.html",children:"Java doc"}),"\nfor more details. Also see\n",(0,s.jsx)(n.a,{href:"https://parquet.apache.org/docs/file-format/configurations/",children:"Parquet documentation"})," for their\nrecommended configurations (512 - 1024 MB block size, 8 KB page size)."]}),"\n",(0,s.jsx)(n.h4,{id:"data-schema-1",children:"Data schema"}),"\n",(0,s.jsx)(n.p,{children:"Under the hood, an HeroPixeldata stream in JSON schema is first converted to an Avro schema, then the\nJSON object is converted to an Avro record, and finally the Avro record is outputted to the Parquet\nformat. Because the data stream can come from any data source, the JSON to Avro conversion process\nhas arbitrary rules and limitations."}),"\n",(0,s.jsx)(n.p,{children:'In order for everything to work correctly, it is also necessary that the user whose "S3 Key Id" and\n"S3 Access Key" are used have access to both the bucket and its contents. Policies to use:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": "s3:*",\n      "Resource": [\n        "arn:aws:s3:::YOUR_BUCKET_NAME/*",\n        "arn:aws:s3:::YOUR_BUCKET_NAME"\n      ]\n    }\n  ]\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},3023:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var s=t(3696);const i={},r=s.createContext(i);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);